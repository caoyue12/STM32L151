ARM GAS  /tmp/cciJBCtS.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"i2c-board.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.I2cMcuInit,"ax",%progbits
  16              		.align	1
  17              		.global	I2cMcuInit
  18              		.syntax unified
  19              		.thumb
  20              		.thumb_func
  21              		.fpu softvfp
  23              	I2cMcuInit:
  24              	.LFB72:
  25              		.file 1 "..//Source/stm/board/board_stm32l151cd/i2c-board.c"
   1:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** /*!
   2:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  * \file      i2c-board.c
   3:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *
   4:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  * \brief     Target board I2C driver implementation
   5:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *
   6:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  * \copyright Revised BSD License, see section \ref LICENSE.
   7:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *
   8:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  * \code
   9:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *                ______                              _
  10:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *               / _____)             _              | |
  11:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *              ( (____  _____ ____ _| |_ _____  ____| |__
  12:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *               \____ \| ___ |    (_   _) ___ |/ ___)  _ \
  13:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *               _____) ) ____| | | || |_| ____( (___| | | |
  14:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *              (______/|_____)_|_|_| \__)_____)\____)_| |_|
  15:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *              (C)2013-2017 Semtech
  16:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *
  17:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  * \endcode
  18:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *
  19:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  * \author    Miguel Luis ( Semtech )
  20:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *
  21:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  * \author    Gregory Cristian ( Semtech )
  22:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  */
  23:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** #include "stm32l1xx.h"
  24:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** #include "utilities.h"
  25:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** #include "board-config.h"
  26:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** #include "i2c-board.h"
  27:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  28:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** /*!
  29:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  *  The value of the maximal timeout for I2C waiting loops
  30:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****  */
  31:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** #define TIMEOUT_MAX                                 0x8000
  32:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  33:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** static I2C_HandleTypeDef I2cHandle = { 0 };
ARM GAS  /tmp/cciJBCtS.s 			page 2


  34:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  35:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** static I2cAddrSize I2cInternalAddrSize = I2C_ADDR_SIZE_8;
  36:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  37:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** void I2cMcuInit( I2c_t *obj, I2cId_t i2cId, PinNames scl, PinNames sda )
  38:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** {
  26              		.loc 1 38 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 8
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              	.LVL0:
  31 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 24
  34              		.cfi_offset 4, -24
  35              		.cfi_offset 5, -20
  36              		.cfi_offset 6, -16
  37              		.cfi_offset 7, -12
  38              		.cfi_offset 8, -8
  39              		.cfi_offset 14, -4
  40 0004 84B0     		sub	sp, sp, #16
  41              	.LCFI1:
  42              		.cfi_def_cfa_offset 40
  43 0006 0446     		mov	r4, r0
  44 0008 1646     		mov	r6, r2
  45 000a 9846     		mov	r8, r3
  39:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_CLK_DISABLE( );
  46              		.loc 1 39 0
  47 000c 174B     		ldr	r3, .L3
  48              	.LVL1:
  49 000e 5A6A     		ldr	r2, [r3, #36]
  50              	.LVL2:
  51 0010 22F40012 		bic	r2, r2, #2097152
  52 0014 5A62     		str	r2, [r3, #36]
  53              	.LBB2:
  40:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_CLK_ENABLE( );
  54              		.loc 1 40 0
  55 0016 5A6A     		ldr	r2, [r3, #36]
  56 0018 42F40012 		orr	r2, r2, #2097152
  57 001c 5A62     		str	r2, [r3, #36]
  58 001e 5A6A     		ldr	r2, [r3, #36]
  59 0020 02F40012 		and	r2, r2, #2097152
  60 0024 0392     		str	r2, [sp, #12]
  61 0026 039A     		ldr	r2, [sp, #12]
  62              	.LBE2:
  41:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_FORCE_RESET( );
  63              		.loc 1 41 0
  64 0028 9A69     		ldr	r2, [r3, #24]
  65 002a 42F40012 		orr	r2, r2, #2097152
  66 002e 9A61     		str	r2, [r3, #24]
  42:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_RELEASE_RESET( );
  67              		.loc 1 42 0
  68 0030 9A69     		ldr	r2, [r3, #24]
  69 0032 22F40012 		bic	r2, r2, #2097152
  70 0036 9A61     		str	r2, [r3, #24]
  43:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  44:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     obj->I2cId = i2cId;
  71              		.loc 1 44 0
ARM GAS  /tmp/cciJBCtS.s 			page 3


  72 0038 00F8041B 		strb	r1, [r0], #4
  73              	.LVL3:
  45:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  46:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cHandle.Instance  = ( I2C_TypeDef * )I2C1_BASE;
  74              		.loc 1 46 0
  75 003c 0C4A     		ldr	r2, .L3+4
  76 003e 0D4B     		ldr	r3, .L3+8
  77 0040 1A60     		str	r2, [r3]
  47:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  48:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     GpioInit( &obj->Scl, scl, PIN_ALTERNATE_FCT, PIN_OPEN_DRAIN, PIN_NO_PULL, GPIO_AF4_I2C1 );
  78              		.loc 1 48 0
  79 0042 0425     		movs	r5, #4
  80 0044 0195     		str	r5, [sp, #4]
  81 0046 0027     		movs	r7, #0
  82 0048 0097     		str	r7, [sp]
  83 004a 0123     		movs	r3, #1
  84 004c 0222     		movs	r2, #2
  85 004e 3146     		mov	r1, r6
  86              	.LVL4:
  87 0050 FFF7FEFF 		bl	GpioInit
  88              	.LVL5:
  49:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     GpioInit( &obj->Sda, sda, PIN_ALTERNATE_FCT, PIN_OPEN_DRAIN, PIN_NO_PULL, GPIO_AF4_I2C1 );
  89              		.loc 1 49 0
  90 0054 0195     		str	r5, [sp, #4]
  91 0056 0097     		str	r7, [sp]
  92 0058 0123     		movs	r3, #1
  93 005a 0222     		movs	r2, #2
  94 005c 4146     		mov	r1, r8
  95 005e 04F11000 		add	r0, r4, #16
  96 0062 FFF7FEFF 		bl	GpioInit
  97              	.LVL6:
  50:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** }
  98              		.loc 1 50 0
  99 0066 04B0     		add	sp, sp, #16
 100              	.LCFI2:
 101              		.cfi_def_cfa_offset 24
 102              		@ sp needed
 103 0068 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 104              	.LVL7:
 105              	.L4:
 106              		.align	2
 107              	.L3:
 108 006c 00380240 		.word	1073887232
 109 0070 00540040 		.word	1073763328
 110 0074 00000000 		.word	.LANCHOR0
 111              		.cfi_endproc
 112              	.LFE72:
 114              		.section	.text.I2cMcuFormat,"ax",%progbits
 115              		.align	1
 116              		.global	I2cMcuFormat
 117              		.syntax unified
 118              		.thumb
 119              		.thumb_func
 120              		.fpu softvfp
 122              	I2cMcuFormat:
 123              	.LFB73:
  51:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
ARM GAS  /tmp/cciJBCtS.s 			page 4


  52:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** void I2cMcuFormat( I2c_t *obj, I2cMode mode, I2cDutyCycle dutyCycle, bool I2cAckEnable, I2cAckAddrM
  53:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** {
 124              		.loc 1 53 0
 125              		.cfi_startproc
 126              		@ args = 8, pretend = 0, frame = 8
 127              		@ frame_needed = 0, uses_anonymous_args = 0
 128              	.LVL8:
 129 0000 00B5     		push	{lr}
 130              	.LCFI3:
 131              		.cfi_def_cfa_offset 4
 132              		.cfi_offset 14, -4
 133 0002 83B0     		sub	sp, sp, #12
 134              	.LCFI4:
 135              		.cfi_def_cfa_offset 16
 136              	.LBB3:
  54:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_CLK_ENABLE( );
 137              		.loc 1 54 0
 138 0004 114B     		ldr	r3, .L10
 139              	.LVL9:
 140 0006 596A     		ldr	r1, [r3, #36]
 141              	.LVL10:
 142 0008 41F40011 		orr	r1, r1, #2097152
 143 000c 5962     		str	r1, [r3, #36]
 144              	.LVL11:
 145 000e 5B6A     		ldr	r3, [r3, #36]
 146 0010 03F40013 		and	r3, r3, #2097152
 147 0014 0193     		str	r3, [sp, #4]
 148 0016 019B     		ldr	r3, [sp, #4]
 149              	.LBE3:
  55:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  56:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cHandle.Init.ClockSpeed = I2cFrequency;
 150              		.loc 1 56 0
 151 0018 0D4B     		ldr	r3, .L10+4
 152 001a 0599     		ldr	r1, [sp, #20]
 153 001c 5960     		str	r1, [r3, #4]
  57:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  58:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     if( dutyCycle == I2C_DUTY_CYCLE_2 )
 154              		.loc 1 58 0
 155 001e 92B1     		cbz	r2, .L9
  59:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     {
  60:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****         I2cHandle.Init.DutyCycle = I2C_DUTYCYCLE_2;
  61:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
  62:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     else
  63:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     {
  64:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****         I2cHandle.Init.DutyCycle = I2C_DUTYCYCLE_16_9;
 156              		.loc 1 64 0
 157 0020 4FF48042 		mov	r2, #16384
 158              	.LVL12:
 159 0024 0A4B     		ldr	r3, .L10+4
 160 0026 9A60     		str	r2, [r3, #8]
 161              	.L7:
  65:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
  66:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  67:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cHandle.Init.OwnAddress1 = 0;
 162              		.loc 1 67 0
 163 0028 0948     		ldr	r0, .L10+4
 164              	.LVL13:
ARM GAS  /tmp/cciJBCtS.s 			page 5


 165 002a 0023     		movs	r3, #0
 166 002c C360     		str	r3, [r0, #12]
  68:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cHandle.Init.AddressingMode = I2C_ADDRESSINGMODE_7BIT;
 167              		.loc 1 68 0
 168 002e 4FF48042 		mov	r2, #16384
 169 0032 0261     		str	r2, [r0, #16]
  69:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cHandle.Init.DualAddressMode = I2C_DUALADDRESS_DISABLE;
 170              		.loc 1 69 0
 171 0034 4361     		str	r3, [r0, #20]
  70:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cHandle.Init.OwnAddress2 = 0;
 172              		.loc 1 70 0
 173 0036 8361     		str	r3, [r0, #24]
  71:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cHandle.Init.GeneralCallMode = I2C_GENERALCALL_DISABLED;
 174              		.loc 1 71 0
 175 0038 C361     		str	r3, [r0, #28]
  72:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cHandle.Init.NoStretchMode = I2C_NOSTRETCH_DISABLED;
 176              		.loc 1 72 0
 177 003a 0362     		str	r3, [r0, #32]
  73:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  74:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     HAL_I2C_Init( &I2cHandle );
 178              		.loc 1 74 0
 179 003c FFF7FEFF 		bl	HAL_I2C_Init
 180              	.LVL14:
  75:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** }
 181              		.loc 1 75 0
 182 0040 03B0     		add	sp, sp, #12
 183              	.LCFI5:
 184              		.cfi_remember_state
 185              		.cfi_def_cfa_offset 4
 186              		@ sp needed
 187 0042 5DF804FB 		ldr	pc, [sp], #4
 188              	.LVL15:
 189              	.L9:
 190              	.LCFI6:
 191              		.cfi_restore_state
  60:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
 192              		.loc 1 60 0
 193 0046 9A60     		str	r2, [r3, #8]
 194 0048 EEE7     		b	.L7
 195              	.L11:
 196 004a 00BF     		.align	2
 197              	.L10:
 198 004c 00380240 		.word	1073887232
 199 0050 00000000 		.word	.LANCHOR0
 200              		.cfi_endproc
 201              	.LFE73:
 203              		.section	.text.I2cMcuResetBus,"ax",%progbits
 204              		.align	1
 205              		.global	I2cMcuResetBus
 206              		.syntax unified
 207              		.thumb
 208              		.thumb_func
 209              		.fpu softvfp
 211              	I2cMcuResetBus:
 212              	.LFB74:
  76:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  77:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** void I2cMcuResetBus( I2c_t *obj )
ARM GAS  /tmp/cciJBCtS.s 			page 6


  78:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** {
 213              		.loc 1 78 0
 214              		.cfi_startproc
 215              		@ args = 0, pretend = 0, frame = 8
 216              		@ frame_needed = 0, uses_anonymous_args = 0
 217              	.LVL16:
 218 0000 70B5     		push	{r4, r5, r6, lr}
 219              	.LCFI7:
 220              		.cfi_def_cfa_offset 16
 221              		.cfi_offset 4, -16
 222              		.cfi_offset 5, -12
 223              		.cfi_offset 6, -8
 224              		.cfi_offset 14, -4
 225 0002 84B0     		sub	sp, sp, #16
 226              	.LCFI8:
 227              		.cfi_def_cfa_offset 32
 228 0004 0546     		mov	r5, r0
  79:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_CLK_DISABLE( );
 229              		.loc 1 79 0
 230 0006 1A4B     		ldr	r3, .L14
 231 0008 5A6A     		ldr	r2, [r3, #36]
 232 000a 22F40012 		bic	r2, r2, #2097152
 233 000e 5A62     		str	r2, [r3, #36]
 234              	.LBB4:
  80:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_CLK_ENABLE( );
 235              		.loc 1 80 0
 236 0010 5A6A     		ldr	r2, [r3, #36]
 237 0012 42F40012 		orr	r2, r2, #2097152
 238 0016 5A62     		str	r2, [r3, #36]
 239 0018 5A6A     		ldr	r2, [r3, #36]
 240 001a 02F40012 		and	r2, r2, #2097152
 241 001e 0392     		str	r2, [sp, #12]
 242 0020 039A     		ldr	r2, [sp, #12]
 243              	.LBE4:
  81:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_FORCE_RESET( );
 244              		.loc 1 81 0
 245 0022 9A69     		ldr	r2, [r3, #24]
 246 0024 42F40012 		orr	r2, r2, #2097152
 247 0028 9A61     		str	r2, [r3, #24]
  82:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_RELEASE_RESET( );
 248              		.loc 1 82 0
 249 002a 9A69     		ldr	r2, [r3, #24]
 250 002c 22F40012 		bic	r2, r2, #2097152
 251 0030 9A61     		str	r2, [r3, #24]
  83:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  84:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     GpioInit( &obj->Scl, I2C_SCL, PIN_ALTERNATE_FCT, PIN_OPEN_DRAIN, PIN_NO_PULL, GPIO_AF4_I2C1 );
 252              		.loc 1 84 0
 253 0032 0426     		movs	r6, #4
 254 0034 0196     		str	r6, [sp, #4]
 255 0036 0024     		movs	r4, #0
 256 0038 0094     		str	r4, [sp]
 257 003a 0123     		movs	r3, #1
 258 003c 0222     		movs	r2, #2
 259 003e 1621     		movs	r1, #22
 260 0040 3044     		add	r0, r0, r6
 261              	.LVL17:
 262 0042 FFF7FEFF 		bl	GpioInit
ARM GAS  /tmp/cciJBCtS.s 			page 7


 263              	.LVL18:
  85:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     GpioInit( &obj->Sda, I2C_SDA, PIN_ALTERNATE_FCT, PIN_OPEN_DRAIN, PIN_NO_PULL, GPIO_AF4_I2C1 );
 264              		.loc 1 85 0
 265 0046 0196     		str	r6, [sp, #4]
 266 0048 0094     		str	r4, [sp]
 267 004a 0123     		movs	r3, #1
 268 004c 0222     		movs	r2, #2
 269 004e 1721     		movs	r1, #23
 270 0050 05F11000 		add	r0, r5, #16
 271 0054 FFF7FEFF 		bl	GpioInit
 272              	.LVL19:
  86:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  87:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cMcuFormat( obj, MODE_I2C, I2C_DUTY_CYCLE_2, true, I2C_ACK_ADD_7_BIT, 400000 );
 273              		.loc 1 87 0
 274 0058 064B     		ldr	r3, .L14+4
 275 005a 0193     		str	r3, [sp, #4]
 276 005c 0094     		str	r4, [sp]
 277 005e 0123     		movs	r3, #1
 278 0060 2246     		mov	r2, r4
 279 0062 2146     		mov	r1, r4
 280 0064 2846     		mov	r0, r5
 281 0066 FFF7FEFF 		bl	I2cMcuFormat
 282              	.LVL20:
  88:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** }
 283              		.loc 1 88 0
 284 006a 04B0     		add	sp, sp, #16
 285              	.LCFI9:
 286              		.cfi_def_cfa_offset 16
 287              		@ sp needed
 288 006c 70BD     		pop	{r4, r5, r6, pc}
 289              	.LVL21:
 290              	.L15:
 291 006e 00BF     		.align	2
 292              	.L14:
 293 0070 00380240 		.word	1073887232
 294 0074 801A0600 		.word	400000
 295              		.cfi_endproc
 296              	.LFE74:
 298              		.section	.text.I2cMcuDeInit,"ax",%progbits
 299              		.align	1
 300              		.global	I2cMcuDeInit
 301              		.syntax unified
 302              		.thumb
 303              		.thumb_func
 304              		.fpu softvfp
 306              	I2cMcuDeInit:
 307              	.LFB75:
  89:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  90:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** void I2cMcuDeInit( I2c_t *obj )
  91:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** {
 308              		.loc 1 91 0
 309              		.cfi_startproc
 310              		@ args = 0, pretend = 0, frame = 0
 311              		@ frame_needed = 0, uses_anonymous_args = 0
 312              	.LVL22:
 313 0000 30B5     		push	{r4, r5, lr}
 314              	.LCFI10:
ARM GAS  /tmp/cciJBCtS.s 			page 8


 315              		.cfi_def_cfa_offset 12
 316              		.cfi_offset 4, -12
 317              		.cfi_offset 5, -8
 318              		.cfi_offset 14, -4
 319 0002 83B0     		sub	sp, sp, #12
 320              	.LCFI11:
 321              		.cfi_def_cfa_offset 24
 322 0004 0446     		mov	r4, r0
  92:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  93:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     HAL_I2C_DeInit( &I2cHandle );
 323              		.loc 1 93 0
 324 0006 1248     		ldr	r0, .L18
 325              	.LVL23:
 326 0008 FFF7FEFF 		bl	HAL_I2C_DeInit
 327              	.LVL24:
  94:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  95:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_FORCE_RESET();
 328              		.loc 1 95 0
 329 000c 114B     		ldr	r3, .L18+4
 330 000e 9A69     		ldr	r2, [r3, #24]
 331 0010 42F40012 		orr	r2, r2, #2097152
 332 0014 9A61     		str	r2, [r3, #24]
  96:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_RELEASE_RESET();
 333              		.loc 1 96 0
 334 0016 9A69     		ldr	r2, [r3, #24]
 335 0018 22F40012 		bic	r2, r2, #2097152
 336 001c 9A61     		str	r2, [r3, #24]
  97:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     __HAL_RCC_I2C1_CLK_DISABLE( );
 337              		.loc 1 97 0
 338 001e 5A6A     		ldr	r2, [r3, #36]
 339 0020 22F40012 		bic	r2, r2, #2097152
 340 0024 5A62     		str	r2, [r3, #36]
  98:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
  99:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     GpioInit( &obj->Scl, obj->Scl.pin, PIN_ANALOGIC, PIN_PUSH_PULL, PIN_NO_PULL, 0 );
 341              		.loc 1 99 0
 342 0026 2046     		mov	r0, r4
 343 0028 10F9041F 		ldrsb	r1, [r0, #4]!
 344 002c 0025     		movs	r5, #0
 345 002e 0195     		str	r5, [sp, #4]
 346 0030 0095     		str	r5, [sp]
 347 0032 2B46     		mov	r3, r5
 348 0034 0322     		movs	r2, #3
 349 0036 FFF7FEFF 		bl	GpioInit
 350              	.LVL25:
 100:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     GpioInit( &obj->Sda, obj->Sda.pin, PIN_ANALOGIC, PIN_PUSH_PULL, PIN_NO_PULL, 0 );
 351              		.loc 1 100 0
 352 003a 2046     		mov	r0, r4
 353 003c 10F9101F 		ldrsb	r1, [r0, #16]!
 354 0040 0195     		str	r5, [sp, #4]
 355 0042 0095     		str	r5, [sp]
 356 0044 2B46     		mov	r3, r5
 357 0046 0322     		movs	r2, #3
 358 0048 FFF7FEFF 		bl	GpioInit
 359              	.LVL26:
 101:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** }
 360              		.loc 1 101 0
 361 004c 03B0     		add	sp, sp, #12
ARM GAS  /tmp/cciJBCtS.s 			page 9


 362              	.LCFI12:
 363              		.cfi_def_cfa_offset 12
 364              		@ sp needed
 365 004e 30BD     		pop	{r4, r5, pc}
 366              	.LVL27:
 367              	.L19:
 368              		.align	2
 369              	.L18:
 370 0050 00000000 		.word	.LANCHOR0
 371 0054 00380240 		.word	1073887232
 372              		.cfi_endproc
 373              	.LFE75:
 375              		.section	.text.I2cSetAddrSize,"ax",%progbits
 376              		.align	1
 377              		.global	I2cSetAddrSize
 378              		.syntax unified
 379              		.thumb
 380              		.thumb_func
 381              		.fpu softvfp
 383              	I2cSetAddrSize:
 384              	.LFB76:
 102:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 103:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** void I2cSetAddrSize( I2c_t *obj, I2cAddrSize addrSize )
 104:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** {
 385              		.loc 1 104 0
 386              		.cfi_startproc
 387              		@ args = 0, pretend = 0, frame = 0
 388              		@ frame_needed = 0, uses_anonymous_args = 0
 389              		@ link register save eliminated.
 390              	.LVL28:
 105:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     I2cInternalAddrSize = addrSize;
 391              		.loc 1 105 0
 392 0000 014B     		ldr	r3, .L21
 393 0002 1970     		strb	r1, [r3]
 394 0004 7047     		bx	lr
 395              	.L22:
 396 0006 00BF     		.align	2
 397              	.L21:
 398 0008 00000000 		.word	.LANCHOR1
 399              		.cfi_endproc
 400              	.LFE76:
 402              		.section	.text.I2cMcuWriteBuffer,"ax",%progbits
 403              		.align	1
 404              		.global	I2cMcuWriteBuffer
 405              		.syntax unified
 406              		.thumb
 407              		.thumb_func
 408              		.fpu softvfp
 410              	I2cMcuWriteBuffer:
 411              	.LFB77:
 106:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** }
 107:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 108:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** uint8_t I2cMcuWriteBuffer( I2c_t *obj, uint8_t deviceAddr, uint16_t addr, uint8_t *buffer, uint16_t
 109:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** {
 412              		.loc 1 109 0
 413              		.cfi_startproc
 414              		@ args = 4, pretend = 0, frame = 0
ARM GAS  /tmp/cciJBCtS.s 			page 10


 415              		@ frame_needed = 0, uses_anonymous_args = 0
 416              	.LVL29:
 417 0000 10B5     		push	{r4, lr}
 418              	.LCFI13:
 419              		.cfi_def_cfa_offset 8
 420              		.cfi_offset 4, -8
 421              		.cfi_offset 14, -4
 422 0002 84B0     		sub	sp, sp, #16
 423              	.LCFI14:
 424              		.cfi_def_cfa_offset 24
 425 0004 1846     		mov	r0, r3
 426              	.LVL30:
 110:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     uint8_t status = FAIL;
 111:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     uint16_t memAddSize = 0;
 112:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 113:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     if( I2cInternalAddrSize == I2C_ADDR_SIZE_8 )
 427              		.loc 1 113 0
 428 0006 0A4B     		ldr	r3, .L28
 429              	.LVL31:
 430 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 431 000a 7BB1     		cbz	r3, .L27
 114:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     {
 115:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****         memAddSize = I2C_MEMADD_SIZE_8BIT;
 116:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
 117:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     else
 118:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     {
 119:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****         memAddSize = I2C_MEMADD_SIZE_16BIT;
 432              		.loc 1 119 0
 433 000c 1023     		movs	r3, #16
 434              	.L24:
 435              	.LVL32:
 120:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
 121:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     status = ( HAL_I2C_Mem_Write( &I2cHandle, deviceAddr, addr, memAddSize, buffer, size, 2000 ) ==
 436              		.loc 1 121 0
 437 000e 4FF4FA64 		mov	r4, #2000
 438 0012 0294     		str	r4, [sp, #8]
 439 0014 BDF81840 		ldrh	r4, [sp, #24]
 440 0018 0194     		str	r4, [sp, #4]
 441 001a 0090     		str	r0, [sp]
 442 001c 0548     		ldr	r0, .L28+4
 443              	.LVL33:
 444 001e FFF7FEFF 		bl	HAL_I2C_Mem_Write
 445              	.LVL34:
 122:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 123:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     return status;
 124:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** }
 446              		.loc 1 124 0
 447 0022 B0FA80F0 		clz	r0, r0
 448              	.LVL35:
 449 0026 4009     		lsrs	r0, r0, #5
 450 0028 04B0     		add	sp, sp, #16
 451              	.LCFI15:
 452              		.cfi_remember_state
 453              		.cfi_def_cfa_offset 8
 454              		@ sp needed
 455 002a 10BD     		pop	{r4, pc}
 456              	.LVL36:
ARM GAS  /tmp/cciJBCtS.s 			page 11


 457              	.L27:
 458              	.LCFI16:
 459              		.cfi_restore_state
 115:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
 460              		.loc 1 115 0
 461 002c 0123     		movs	r3, #1
 462 002e EEE7     		b	.L24
 463              	.L29:
 464              		.align	2
 465              	.L28:
 466 0030 00000000 		.word	.LANCHOR1
 467 0034 00000000 		.word	.LANCHOR0
 468              		.cfi_endproc
 469              	.LFE77:
 471              		.section	.text.I2cMcuReadBuffer,"ax",%progbits
 472              		.align	1
 473              		.global	I2cMcuReadBuffer
 474              		.syntax unified
 475              		.thumb
 476              		.thumb_func
 477              		.fpu softvfp
 479              	I2cMcuReadBuffer:
 480              	.LFB78:
 125:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 126:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** uint8_t I2cMcuReadBuffer( I2c_t *obj, uint8_t deviceAddr, uint16_t addr, uint8_t *buffer, uint16_t 
 127:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** {
 481              		.loc 1 127 0
 482              		.cfi_startproc
 483              		@ args = 4, pretend = 0, frame = 0
 484              		@ frame_needed = 0, uses_anonymous_args = 0
 485              	.LVL37:
 486 0000 10B5     		push	{r4, lr}
 487              	.LCFI17:
 488              		.cfi_def_cfa_offset 8
 489              		.cfi_offset 4, -8
 490              		.cfi_offset 14, -4
 491 0002 84B0     		sub	sp, sp, #16
 492              	.LCFI18:
 493              		.cfi_def_cfa_offset 24
 494 0004 1846     		mov	r0, r3
 495              	.LVL38:
 128:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     uint8_t status = FAIL;
 129:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     uint16_t memAddSize = 0;
 130:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 131:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     if( I2cInternalAddrSize == I2C_ADDR_SIZE_8 )
 496              		.loc 1 131 0
 497 0006 0A4B     		ldr	r3, .L35
 498              	.LVL39:
 499 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 500 000a 7BB1     		cbz	r3, .L34
 132:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     {
 133:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****         memAddSize = I2C_MEMADD_SIZE_8BIT;
 134:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
 135:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     else
 136:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     {
 137:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****         memAddSize = I2C_MEMADD_SIZE_16BIT;
 501              		.loc 1 137 0
ARM GAS  /tmp/cciJBCtS.s 			page 12


 502 000c 1023     		movs	r3, #16
 503              	.L31:
 504              	.LVL40:
 138:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
 139:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     status = ( HAL_I2C_Mem_Read( &I2cHandle, deviceAddr, addr, memAddSize, buffer, size, 2000 ) == 
 505              		.loc 1 139 0
 506 000e 4FF4FA64 		mov	r4, #2000
 507 0012 0294     		str	r4, [sp, #8]
 508 0014 BDF81840 		ldrh	r4, [sp, #24]
 509 0018 0194     		str	r4, [sp, #4]
 510 001a 0090     		str	r0, [sp]
 511 001c 0548     		ldr	r0, .L35+4
 512              	.LVL41:
 513 001e FFF7FEFF 		bl	HAL_I2C_Mem_Read
 514              	.LVL42:
 140:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 141:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     return status;
 142:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** }
 515              		.loc 1 142 0
 516 0022 B0FA80F0 		clz	r0, r0
 517              	.LVL43:
 518 0026 4009     		lsrs	r0, r0, #5
 519 0028 04B0     		add	sp, sp, #16
 520              	.LCFI19:
 521              		.cfi_remember_state
 522              		.cfi_def_cfa_offset 8
 523              		@ sp needed
 524 002a 10BD     		pop	{r4, pc}
 525              	.LVL44:
 526              	.L34:
 527              	.LCFI20:
 528              		.cfi_restore_state
 133:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     }
 529              		.loc 1 133 0
 530 002c 0123     		movs	r3, #1
 531 002e EEE7     		b	.L31
 532              	.L36:
 533              		.align	2
 534              	.L35:
 535 0030 00000000 		.word	.LANCHOR1
 536 0034 00000000 		.word	.LANCHOR0
 537              		.cfi_endproc
 538              	.LFE78:
 540              		.section	.text.I2cMcuWaitStandbyState,"ax",%progbits
 541              		.align	1
 542              		.global	I2cMcuWaitStandbyState
 543              		.syntax unified
 544              		.thumb
 545              		.thumb_func
 546              		.fpu softvfp
 548              	I2cMcuWaitStandbyState:
 549              	.LFB79:
 143:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 144:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** uint8_t I2cMcuWaitStandbyState( I2c_t *obj, uint8_t deviceAddr )
 145:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** {
 550              		.loc 1 145 0
 551              		.cfi_startproc
ARM GAS  /tmp/cciJBCtS.s 			page 13


 552              		@ args = 0, pretend = 0, frame = 0
 553              		@ frame_needed = 0, uses_anonymous_args = 0
 554              	.LVL45:
 555 0000 08B5     		push	{r3, lr}
 556              	.LCFI21:
 557              		.cfi_def_cfa_offset 8
 558              		.cfi_offset 3, -8
 559              		.cfi_offset 14, -4
 560              	.LVL46:
 146:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     uint8_t status = FAIL;
 147:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 148:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     status = ( HAL_I2C_IsDeviceReady( &I2cHandle, deviceAddr, 300, 4096 ) == HAL_OK ) ? SUCCESS : F
 561              		.loc 1 148 0
 562 0002 4FF48053 		mov	r3, #4096
 563 0006 4FF49672 		mov	r2, #300
 564 000a 0348     		ldr	r0, .L39
 565              	.LVL47:
 566 000c FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 567              	.LVL48:
 149:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** 
 150:..//Source/stm/board/board_stm32l151cd/i2c-board.c ****     return status;
 151:..//Source/stm/board/board_stm32l151cd/i2c-board.c **** }
 568              		.loc 1 151 0
 569 0010 B0FA80F0 		clz	r0, r0
 570              	.LVL49:
 571 0014 4009     		lsrs	r0, r0, #5
 572 0016 08BD     		pop	{r3, pc}
 573              	.L40:
 574              		.align	2
 575              	.L39:
 576 0018 00000000 		.word	.LANCHOR0
 577              		.cfi_endproc
 578              	.LFE79:
 580              		.section	.bss.I2cHandle,"aw",%nobits
 581              		.align	2
 582              		.set	.LANCHOR0,. + 0
 585              	I2cHandle:
 586 0000 00000000 		.space	84
 586      00000000 
 586      00000000 
 586      00000000 
 586      00000000 
 587              		.section	.bss.I2cInternalAddrSize,"aw",%nobits
 588              		.set	.LANCHOR1,. + 0
 591              	I2cInternalAddrSize:
 592 0000 00       		.space	1
 593              		.text
 594              	.Letext0:
 595              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 596              		.file 3 "/usr/include/newlib/sys/_stdint.h"
 597              		.file 4 "..//Source/stm/lib/CMSIS/Include/core_cm3.h"
 598              		.file 5 "..//Source/stm/lib/CMSIS/Device/ST/STM32L1xx/Include/system_stm32l1xx.h"
 599              		.file 6 "..//Source/stm/lib/CMSIS/Device/ST/STM32L1xx/Include/stm32l151xba.h"
 600              		.file 7 "..//Source/stm/lib/STM32L1xx_HAL_Driver/Inc/stm32l1xx_hal_def.h"
 601              		.file 8 "..//Source/stm/lib/STM32L1xx_HAL_Driver/Inc/stm32l1xx_hal_dma.h"
 602              		.file 9 "..//Source/stm/lib/STM32L1xx_HAL_Driver/Inc/stm32l1xx_hal_i2c.h"
 603              		.file 10 "..//Source/stm/lib/STM32L1xx_HAL_Driver/Inc/stm32l1xx_hal.h"
ARM GAS  /tmp/cciJBCtS.s 			page 14


 604              		.file 11 "..//Source/stm/hal/gpio.h"
 605              		.file 12 "..//Source/stm/hal/i2c.h"
 606              		.file 13 "..//Source/stm/board/i2c-board.h"
ARM GAS  /tmp/cciJBCtS.s 			page 15


DEFINED SYMBOLS
                            *ABS*:0000000000000000 i2c-board.c
     /tmp/cciJBCtS.s:16     .text.I2cMcuInit:0000000000000000 $t
     /tmp/cciJBCtS.s:23     .text.I2cMcuInit:0000000000000000 I2cMcuInit
     /tmp/cciJBCtS.s:108    .text.I2cMcuInit:000000000000006c $d
     /tmp/cciJBCtS.s:115    .text.I2cMcuFormat:0000000000000000 $t
     /tmp/cciJBCtS.s:122    .text.I2cMcuFormat:0000000000000000 I2cMcuFormat
     /tmp/cciJBCtS.s:198    .text.I2cMcuFormat:000000000000004c $d
     /tmp/cciJBCtS.s:204    .text.I2cMcuResetBus:0000000000000000 $t
     /tmp/cciJBCtS.s:211    .text.I2cMcuResetBus:0000000000000000 I2cMcuResetBus
     /tmp/cciJBCtS.s:293    .text.I2cMcuResetBus:0000000000000070 $d
     /tmp/cciJBCtS.s:299    .text.I2cMcuDeInit:0000000000000000 $t
     /tmp/cciJBCtS.s:306    .text.I2cMcuDeInit:0000000000000000 I2cMcuDeInit
     /tmp/cciJBCtS.s:370    .text.I2cMcuDeInit:0000000000000050 $d
     /tmp/cciJBCtS.s:376    .text.I2cSetAddrSize:0000000000000000 $t
     /tmp/cciJBCtS.s:383    .text.I2cSetAddrSize:0000000000000000 I2cSetAddrSize
     /tmp/cciJBCtS.s:398    .text.I2cSetAddrSize:0000000000000008 $d
     /tmp/cciJBCtS.s:403    .text.I2cMcuWriteBuffer:0000000000000000 $t
     /tmp/cciJBCtS.s:410    .text.I2cMcuWriteBuffer:0000000000000000 I2cMcuWriteBuffer
     /tmp/cciJBCtS.s:466    .text.I2cMcuWriteBuffer:0000000000000030 $d
     /tmp/cciJBCtS.s:472    .text.I2cMcuReadBuffer:0000000000000000 $t
     /tmp/cciJBCtS.s:479    .text.I2cMcuReadBuffer:0000000000000000 I2cMcuReadBuffer
     /tmp/cciJBCtS.s:535    .text.I2cMcuReadBuffer:0000000000000030 $d
     /tmp/cciJBCtS.s:541    .text.I2cMcuWaitStandbyState:0000000000000000 $t
     /tmp/cciJBCtS.s:548    .text.I2cMcuWaitStandbyState:0000000000000000 I2cMcuWaitStandbyState
     /tmp/cciJBCtS.s:576    .text.I2cMcuWaitStandbyState:0000000000000018 $d
     /tmp/cciJBCtS.s:581    .bss.I2cHandle:0000000000000000 $d
     /tmp/cciJBCtS.s:585    .bss.I2cHandle:0000000000000000 I2cHandle
     /tmp/cciJBCtS.s:591    .bss.I2cInternalAddrSize:0000000000000000 I2cInternalAddrSize
     /tmp/cciJBCtS.s:592    .bss.I2cInternalAddrSize:0000000000000000 $d
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
GpioInit
HAL_I2C_Init
HAL_I2C_DeInit
HAL_I2C_Mem_Write
HAL_I2C_Mem_Read
HAL_I2C_IsDeviceReady
